<div class="lock-account-container">
  <div class="card">
    <div class="card-header">
      <div class="lock-icon">ðŸ”’</div>
      <h2>Account Locked</h2>
      @if (isAutoLocked) {
        <p class="subtitle">
          Your account has been temporarily locked due to multiple failed login attempts.
        </p>
      }
      @if (!isAutoLocked) {
        <p class="subtitle">
          Request an unlock link to regain access to your account.
        </p>
      }
    </div>

    <div class="card-body">
      @if (isAutoLocked) {
        <div class="alert alert-warning">
          <strong>Security Notice:</strong> For your protection, we've locked your account after several unsuccessful login attempts.
        </div>
      }

      @if (!success) {
        <form [formGroup]="unlockForm" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label for="email">Email Address</label>
            <input
              type="email"
              id="email"
              formControlName="email"
              class="form-control"
              [class.is-invalid]="unlockForm.get('email')?.invalid && (unlockForm.get('email')?.touched || unlockForm.get('email')?.dirty)"
              placeholder="Enter your email address">
            @if (unlockForm.get('email')?.invalid && unlockForm.get('email')?.touched) {
              <div class="invalid-feedback">
                @if (unlockForm.get('email')?.errors?.['required']) {
                  <span>Email is required</span>
                }
                @if (unlockForm.get('email')?.errors?.['email']) {
                  <span>Please enter a valid email address</span>
                }
              </div>
            }
          </div>

          <button
            type="submit"
            class="btn btn-primary btn-block"
            [disabled]="loading || countdown > 0 || unlockForm.invalid">
            @if (loading) {
              <span class="spinner-border spinner-border-sm mr-2"></span>
            }
            {{ countdown > 0 ? ('Resend in ' + countdown + 's') : 'Send Unlock Instructions' }}
          </button>
        </form>
      } @else {
        <div class="success-message text-center">
          <div class="success-icon">âœ“</div>
          <h3>Unlock Email Sent!</h3>
          <p>We've sent account unlock instructions to your email address. Please check your inbox and follow the link to unlock your account.</p>
          <div class="success-actions">
            <button
              type="button"
              class="btn btn-outline-primary"
              (click)="onSubmit()"
              [disabled]="countdown > 0">
              {{ countdown > 0 ? ('Resend in ' + countdown + 's') : 'Resend Email' }}
            </button>
          </div>
        </div>
      }

      <div class="additional-options">
        <div class="option-card">
          <h4>Try Login Again</h4>
          <p>If you remember your password, you can try logging in again.</p>
          <button type="button" class="btn btn-outline-secondary btn-sm" (click)="attemptLogin()">
            Try Login
          </button>
        </div>

        <div class="option-card">
          <h4>Need Help?</h4>
          <p>If you're still having trouble, contact our support team.</p>
          <button type="button" class="btn btn-outline-secondary btn-sm" (click)="navigateToSupport()">
            Contact Support
          </button>
        </div>
      </div>

      <div class="text-center links">
        <a (click)="attemptLogin()" class="link">Back to Login</a>
        <span class="divider">â€¢</span>
        <a routerLink="/auth/forgot-password" class="link">Forgot Password?</a>
      </div>
    </div>
  </div>
</div>